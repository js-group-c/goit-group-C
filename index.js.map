{"version":3,"file":"index.js","sources":["../src/js/warnings.js","../src/js/all-categories.js","../src/js/main-page.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function showNoBooksAlert() {\n  iziToast.show({\n    message: 'There are no more books in this category',\n    position: 'topRight',\n    backgroundColor: '#EAC645',\n  });\n}","const url = 'https://books-backend.p.goit.global/books/category-list';\nfetch(url)\n  .then(response => {\n    return response.json();\n  })\n  .then(data => {\n    data.forEach(cat => {\n      const markup = `<li class=\"ctg\"><a href=\"#\" class='sideCat'>${cat.list_name}</a></li>`;\n      document\n        .getElementById('categories')\n        .insertAdjacentHTML('beforeend', markup);\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n","import { getTopBooks, getBooksByCategory } from './booksAPI.js';\nimport { spinnerPlay, spinnerStop } from './spinner.js';\nimport { onOpenModal } from './modal.js';\nimport { showNoBooksAlert } from './warnings.js';\n\nconst references = {\n  topListElem: document.querySelector('#topList'),\n  categoryListElem: document.querySelector('#categoryList'),\n  titleElement: document.querySelector('.top_list-title'),\n  allCategoriesElement: document.querySelector('#categories'),\n};\n\nlet noBooksAlertShow = false;\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  document.addEventListener('click', clickSeeMore); //See More butonuna tıklanınca ilgili kategoriye ait kitapları gösterir.\n  document.addEventListener('click', clickByBook); //Bir kitap kartına tıklanınca detaylarını gösteren modal açar.\n  document.addEventListener('click', clickByAllCategories); //Bir kategoriye tıklanınca bu kategorinin kitapları gösterir.\n  window.addEventListener('scroll', scrollHandler); //Sayfanın en altına kaydırıldığında kategorinin boş olup olmadığını kontrol eder.\n});\n\n//En Çok Satanlar Listesini Getirme\ndocument.addEventListener('DOMContentLoaded', async function () {\n  spinnerPlay(references.titleElement);\n  references.topListElem.innerHTML = '';\n  const topListData = getTopBooks();\n  const topList = await topListData;\n  let html = '';\n  topList.forEach(elem => {\n    html += renderTopList(elem);\n  });\n  references.topListElem.innerHTML = html;\n  spinnerStop();\n});\n\n//En Çok Satanlar Listesini Renderleme\nfunction renderTopList(elem) {\n  return `<li class=\"top_list-container\">\n            <h2 class=\"top_list-category_name\">${elem.list_name}</h2>\n            <ul class=\"top_list-cards\">${renderBooks(elem.books)}</ul>\n            <button class=\"top_list-see_more\" data-category=\"${\n              elem.list_name\n            }\">See More</button>\n        </li>`;\n}\n\n//Kitap kartlarının oluşturulması (kapak, başlık ve yazar ismi)\nfunction renderBooks(books) {\n  let i = 1;\n\n  const filteredBooks = books.filter(book => book.book_image);\n  const booksToShow = [];\n\n  for (let j = 0; j < filteredBooks.length; j++) {\n    booksToShow.push(filteredBooks[j]);\n  }\n\n  while (booksToShow.length < 5) {\n    booksToShow.push(filteredBooks[booksToShow.length % filteredBooks.length]);\n  }\n\n  const bookHtml = booksToShow\n    .map(\n      book =>\n        `\n        <li class=\"top_list-card\" data-book-sequence-number=\"${i++}\">\n            <div class=\"top_list-book_cover_wrapper\" data-bookid=\"${book._id}\">\n                <img class=\"top_list-book_cover\" src=\"${\n                  book.book_image\n                }\" alt=\"${book.title}\">\n            <p class=\"top_list-quick\">QUICK VIEW</p>\n                </div>\n            \n            <h3 class=\"top_list-book_title\">${book.title}</h3>\n            <p class=\"top_list-book_author\">${book.author}</p>\n        </li>\n        `\n    )\n    .join('');\n  i++;\n  return bookHtml;\n}\n\nconst clickByBook = function (event) {\n  const bookWrapper = event.target.closest('.top_list-book_cover_wrapper');\n  if (bookWrapper) {\n    const bookId = bookWrapper.dataset.bookid;\n    onOpenModal(bookId); //Kitap ID' si ile birlikte modal açma fonksiyonunu çalıştırır.\n  }\n};\n\nconst clickSeeMore = function (event) {\n  if (event.target.classList.contains('top_list-see_more')) {\n    references.topListElem.classList.add('hidden'); //Üst kısımdaki kitap listesi gizlenir.\n    references.categoryListElem.classList.remove('hidden'); //Kategorilerin bulunduğu liste alanı gösterilir.\n    const category = event.target.dataset.category;\n    titleCategory(category); //Seçilen kategorinin başlığını değiştirir.\n    categoryList(category); //Seçilen kategoriye ait kitapları getirip listeler.\n    allCategoriesActive(category); //Seçilen kategoriyi aktif hale getirir. Görsel vurgulama ekler.\n  }\n};\n\nconst clickByAllCategories = async function (event) {\n  if (event.target.classList.contains('all-categories')) {\n    //All Kategories butonuna tıklandığında;\n    references.titleElement.innerHTML = 'Best Sellers <span>Books</span>';\n    references.categoryListElem.classList.add('hidden');\n    references.topListElem.classList.remove('hidden');\n    allCategoriesActive('All categories');\n  }\n  if (event.target.classList.contains('sideCat')) {\n    //Kategori listesine (bağlantısına) tıklandığında;\n    const category = event.target.textContent.trim();\n    titleCategory(category);\n    references.categoryListElem.classList.remove('hidden');\n    references.topListElem.classList.add('hidden');\n    allCategoriesActive(category);\n    await categoryList(category); //Seçilen kategoriye ait kitapları getirir.\n\n    spinnerPlay(references.categoryListElem);\n    try {\n      await categoryList(category);\n    } finally {\n      spinnerStop();\n    }\n  }\n};\n\n//Kategoriye Ait Kitapların Listesini Getirme\nasync function categoryList(category) {\n  try {\n    spinnerPlay(references.titleElement);\n    references.categoryListElem.innerHTML = '';\n\n    const categoryData = await getBooksByCategory(category);\n    let html = '';\n\n    categoryData.forEach(book => {\n      if (book.book_image) {\n        html += `\n          <li class=\"category_list-card\">\n              <div class=\"top_list-book_cover_wrapper\" data-bookid=\"${book._id}\">\n                  <img class=\"top_list-book_cover\" src=\"${book.book_image}\" alt=\"${book.title}\">\n              </div>\n              <h3 class=\"top_list-book_title\">${book.title}</h3>\n              <p class=\"top_list-book_author\">${book.author}</p>\n          </li>\n          `;\n      }\n    });\n\n    html += `<p class=\"all_categories\"</p>`;\n    references.categoryListElem.innerHTML = html;\n  } catch (error) {\n    console.error('Kategori verisi alınırken hata oluştu:', error);\n    references.categoryListElem.innerHTML =\n      '<p>Kitaplar yüklenirken bir hata oluştu.</p>';\n  } finally {\n    spinnerStop();\n  }\n}\n\n//Seçilen kategori adını sayfa başlığı olarak gösterir.\nfunction titleCategory(category) {\n  references.titleElement.innerHTML = '';\n\n  const words = category.split(' ');\n  if (words.length === 1) {\n    references.titleElement.textContent = category;\n    return;\n  }\n\n  const lastWord = words.pop();\n  references.titleElement.textContent = words.join(' ');\n\n  const spanElement = document.createElement('span');\n  spanElement.textContent = ' ' + lastWord;\n  references.titleElement.appendChild(spanElement);\n}\n\n//Seçilen kategori aktif olur.\nfunction allCategoriesActive(category) {\n  const categories = document.querySelectorAll('.ctg'); // Tüm kategori bağlantılarını seçer.\n\n  categories.forEach(link => {\n    if (link.textContent.trim().toLowerCase() === category.toLowerCase()) {\n      link.classList.add('active');\n    } else {\n      link.classList.remove('active');\n    }\n  });\n}\n\n//Sayfa en alta kaydırıldığında seçilen kategoriye ait kitap yoksa bu kategoride kitap bulunmamaktadır uyarısı verir.\nfunction scrollHandler() {\n  const endCategories = document.querySelector('.all_categories');\n  if (endCategories) {\n    const endCatPosition = endCategories.getBoundingClientRect(); //Konum alınır.\n    const windowHeight = window.innerHeight; //Kullanıcının görünür pencere yükseliğini alır.\n\n    if (\n      endCatPosition.top < windowHeight &&\n      !noBooksAlertShow &&\n      references.topListElem.classList.contains('hidden')\n    ) {\n      showNoBooksAlert();\n      noBooksAlertShow = true;\n    }\n  }\n}\n\n//Sayfanın en alta gelip gelmediğini kontrol eder ve uyarı mesajı gösterir.\nlet scrollTimeout;\n\nwindow.addEventListener('scroll', function () {\n  if (scrollTimeout) {\n    clearTimeout(scrollTimeout);\n  }\n\n  scrollTimeout = setTimeout(function () {\n    scrollHandler();\n  }, 300);\n});\n\n//Scroll Up Butonu\nconst scrollTopBtn = document.getElementById('scrollToTopBtn');\ndocument.body.scrollTop = 0;\ndocument.documentElement.scrollTop = 0;\n\nscrollTopBtn.addEventListener('click', onScrollBtnClick);\nwindow.addEventListener('scroll', onScroll);\n\nfunction onScroll() {\n  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {\n    document.getElementById('scrollToTopBtn').style.display = 'block';\n    scrollTopBtn.classList.remove('btnHidden');\n  } else {\n    document.getElementById('scrollToTopBtn').style.display = 'none';\n  }\n}\n\nfunction onScrollBtnClick() {\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n}\n"],"names":["showNoBooksAlert","iziToast","url","response","data","cat","markup","error","references","noBooksAlertShow","clickSeeMore","clickByBook","clickByAllCategories","scrollHandler","spinnerPlay","topList","getTopBooks","html","elem","renderTopList","spinnerStop","renderBooks","books","i","filteredBooks","book","booksToShow","j","bookHtml","event","bookWrapper","bookId","onOpenModal","category","titleCategory","categoryList","allCategoriesActive","categoryData","getBooksByCategory","words","lastWord","spanElement","link","endCategories","endCatPosition","windowHeight","scrollTimeout","scrollTopBtn","onScrollBtnClick","onScroll"],"mappings":"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"}